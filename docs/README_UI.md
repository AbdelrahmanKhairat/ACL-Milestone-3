# Airline Company Flight Insights Assistant - UI Guide

## Overview

This Streamlit-based UI demonstrates the Graph-RAG Travel Assistant system for Milestone 3.

## Features

### ‚úÖ Required Features (Step 4)

1. **View KG-Retrieved Context** - Shows raw graph data before LLM processing
2. **View Final LLM Answer** - Displays the LLM's response

### ‚úÖ Optional Features Implemented

1. **Model Selection Dropdown** - Switch between Qwen, OpenAI, and Llama models
2. **Retrieval Method Selection** - Choose baseline (Cypher), embeddings, or both
3. **Cypher Queries Display** - View executed queries (optional toggle)
4. **Detailed Metrics** - Response time, token counts, retrieval statistics

## Installation

### 1. Install Streamlit

```bash
cd c:\Users\LOQ\Desktop\ACL-Milestone-3
venv\Scripts\pip.exe install streamlit
```

### 2. Verify Installation

```bash
venv\Scripts\streamlit.exe --version
```

## Running the Application

### Method 1: Using the virtual environment

```bash
cd c:\Users\LOQ\Desktop\ACL-Milestone-3
venv\Scripts\streamlit.exe run app.py
```

### Method 2: Using Python directly

```bash
cd c:\Users\LOQ\Desktop\ACL-Milestone-3
venv\Scripts\python.exe -m streamlit run app.py
```

The app will open automatically in your browser at `http://localhost:8501`

## Using the UI

### Sidebar Configuration

1. **HuggingFace Token** - Enter your HF token (pre-filled by default)
2. **LLM Model** - Select from:
   - Qwen (default, best quality)
   - OpenAI (via Groq)
   - Llama
3. **Retrieval Method**:
   - ‚úÖ Cypher Queries (baseline)
   - ‚úÖ Semantic Embeddings
   - Or both (hybrid approach)
4. **Display Options**:
   - Show Retrieved Context
   - Show Cypher Query
   - Show Detailed Metrics

### Main Interface

1. **Question Input**:
   - Type your question manually
   - Or select from example questions

2. **Example Questions**:
   - "Which flights have the longest delays?"
   - "Show me flights with delays from ORD"
   - "Which flights have poor passenger experience?"
   - "Find economy class flights"
   - And more...

3. **Results Display**:
   - **Retrieval Statistics**: Cypher count, embedding count, response time
   - **Intent & Entities**: Detected intent and extracted entities
   - **Retrieved Context**: Raw KG data sent to LLM
   - **Cypher Query**: Executed query (if enabled)
   - **Assistant Answer**: Final LLM response
   - **Additional Metrics**: Prompt/response lengths

## UI Components

### üìä Retrieval Statistics
Shows:
- Number of Cypher results
- Number of embedding results
- LLM response time

### üéØ Intent Detection
Displays the classified intent:
- `delay_analysis`
- `find_flights`
- `passenger_experience`
- `general_query`
- etc.

### üè∑Ô∏è Entity Extraction
Shows extracted entities:
- Airports (ORD, CAI, DXB, etc.)
- Passenger class (Economy, Business)
- Routes
- Flight numbers

### üì¶ Retrieved Context
Raw knowledge graph data before LLM processing:
- Journey nodes with properties
- Flight information
- Passenger satisfaction scores
- Delay metrics

### üí° Assistant Answer
Final answer generated by the LLM using the KG context.

## Features Overview

| Feature | Status | Description |
|---------|--------|-------------|
| View KG Context | ‚úÖ | Display raw graph data |
| View LLM Answer | ‚úÖ | Show final response |
| Model Selection | ‚úÖ | Switch between 3 LLMs |
| Retrieval Method | ‚úÖ | Baseline, embeddings, or both |
| Cypher Queries | ‚úÖ | Show executed queries |
| Metrics Display | ‚úÖ | Response time, counts, lengths |
| Example Questions | ‚úÖ | Pre-populated questions |
| Custom Styling | ‚úÖ | Professional UI design |

## Architecture

```
User Question
    ‚Üì
[Streamlit UI]
    ‚Üì
[GraphRAGPipeline]
    ‚Üì
[1. Preprocessing]
    - Intent Classification
    - Entity Extraction
    ‚Üì
[2. Retrieval Layer]
    - Cypher Queries (baseline)
    - Embedding Search (semantic)
    ‚Üì
[3. LLM Layer]
    - Combine results
    - Build structured prompt
    - Query LLM (Qwen/OpenAI/Llama)
    ‚Üì
[Display Results]
    - Context
    - Answer
    - Metrics
```

## Troubleshooting

### Issue: Streamlit not found
**Solution:**
```bash
venv\Scripts\pip.exe install streamlit
```

### Issue: HuggingFace 402 Error (exceeded credits)
**Solution:**
- The free tier has monthly limits
- Use a different HF account
- Or wait until next month

### Issue: Neo4j connection error
**Solution:**
- Verify Neo4j is running
- Check `config.txt` for correct credentials
- Test connection with `neo4j_connector.py`

### Issue: App doesn't update after code changes
**Solution:**
- Streamlit auto-reloads on file changes
- Or click "Rerun" button in the UI
- Or press 'R' in the terminal

## Customization

### Change Default Model
Edit line in `app.py`:
```python
model_choice = st.selectbox(
    "Select Model",
    options=["qwen", "openai", "llama"],
    index=0,  # Change to 1 for OpenAI, 2 for Llama
)
```

### Add More Example Questions
Edit `example_questions` list in `app.py`:
```python
example_questions = [
    "Your custom question here",
    # ... more questions
]
```

### Modify UI Colors
Edit CSS in `st.markdown()` section.

## Screenshot Guide

When taking screenshots for your presentation:

1. **Main Interface** - Show the full UI with sidebar
2. **Example Question** - Run "Which flights have the longest delays?"
3. **Retrieved Context** - Expand the context view
4. **Model Comparison** - Switch models and compare answers
5. **Metrics Display** - Show detailed statistics

## Performance Tips

1. **Caching**: The pipeline is cached using `@st.cache_resource`
2. **Model Selection**: Qwen is fastest and most reliable
3. **Retrieval Method**: Using both gives best results but is slower

## Notes

- The UI uses caching to avoid re-initializing the pipeline
- Default HF token is pre-filled (update in sidebar)
- Context display is truncated to 5000 chars for readability
- Full context is available in the expander

## Milestone 3 Compliance

This UI fulfills **Step 4** requirements:

‚úÖ **Required:**
- View KG-retrieved context
- View final LLM answer

‚úÖ **Optional (all implemented):**
- Cypher queries executed
- Model selection dropdown (3 models)
- Retrieval method selection
- Additional metrics and visualizations

---

**Ready to demo your Graph-RAG system!** üöÄ
